# 🧠 ارتباط فرزند به والد در React (Child to Parent Communication)

در React، داده‌ها همیشه از والد به فرزند (از بالا به پایین) منتقل می‌شن.  
اما گاهی لازمه فرزند کاری بکنه که والد رو تغییر بده — مثلاً حذف یک آیتم از لیست.  
در این مواقع، فرزند از طریق تابعی که والد بهش داده، به والد پیام می‌ده.

---

## 📝 سناریو: حذف آیتم از لیست

فرض کنیم در والد، یک لیست آیتم داریم.  
هر آیتم در یک کامپوننت فرزند (مثلاً Item) رندر می‌شه.  
می‌خواهیم وقتی روی دکمه «حذف» در فرزند کلیک کردیم، اون آیتم از لیست حذف بشه.

---

## ✅ مراحل قدم به قدم:

1. **در کامپوننت والد:**

   - یک state برای لیست تعریف می‌کنیم.
   - یک تابع `handleDelete` تعریف می‌کنیم که یک آیتم رو بر اساس `id` حذف کنه.
   - این تابع رو به عنوان prop به کامپوننت فرزند می‌فرستیم.

2. **در کامپوننت فرزند:**

   - prop دریافتی `onDelete` رو می‌گیریم.
   - هنگام کلیک روی دکمه، `onDelete(item.id)` رو صدا می‌زنیم.

---

## 💡 نکته کلیدی:

فرزند مستقیماً state والد رو تغییر نمی‌ده،  
بلکه فقط درخواستی برای تغییر به والد می‌ده  
(از طریق تابعی که والد بهش داده).

---

## 🧪 مثال:

**در App.js (والد):**

```jsx
const [items, setItems] = useState([
  { id: 1, name: "کتاب" },
  { id: 2, name: "دفتر" },
]);

const handleDelete = (id) => {
  setItems((prevItems) => prevItems.filter((item) => item.id !== id));
};
```

** در Item.js (فرزند): **

```jsx
<button onClick={() => onDelete(item.id)}>حذف</button>
```

---

## ✅ نتیجه:

با کلیک روی دکمه "حذف" در فرزند،
تابع handleDelete که در والد تعریف شده، اجرا می‌شه
و اون آیتم از لیست حذف می‌شه

---

---

---

---

---

# Updating An Item در React

# عملیات پیچیده با داده‌های Immutable

برای انجام عملیات **بروزرسانی یک آیتم** (Updating an Item) در React با داده‌های غیرقابل تغییر (Immutable Data) و پیچیده‌تر، معمولاً باید:

- **نسخه‌ای جدید از داده‌ها بسازیم** بدون تغییر مستقیم داده اصلی.
- **آیتم مورد نظر را پیدا کنیم** و مقدارش را تغییر دهیم.
- داده‌های به‌روزشده را در state قرار دهیم.

---

# مثال فرضی: بروز رسانی یک آیتم در یک آرایه آبجکت‌ها

# فرض کن یک آرایه آبجکت داریم مثل:

```jsx
const [items, setItems] = useState([
  { id: 1, name: "کتاب", quantity: 1 },
  { id: 2, name: "دفتر", quantity: 3 },
]);
```

# می‌خواهیم مقدار quantity آیتم با id مشخص را آپدیت کنیم.

#### گام‌های انجام بروزرسانی بدون تغییر مستقیم (Immutable Update):

```jsx
const updateItemQuantity = (id, newQuantity) => {
  setItems((prevItems) =>
    prevItems.map(
      (item) =>
        item.id === id
          ? { ...item, quantity: newQuantity } // کپی آیتم و تغییر مقدار مورد نظر
          : item // بقیه آیتم‌ها بدون تغییر
    )
  );
};
```

# توضیح

\*\* از map استفاده می‌کنیم تا آرایه جدید بسازیم.

\*\* برای هر آیتم چک می‌کنیم که آیا id آن با id مورد نظر برابر است یا نه.

\*\* اگر برابر بود، یک نسخه کپی شده از آن آیتم می‌سازیم که مقدار quantity آن تغییر کرده.

\*\* اگر برابر نبود، آیتم را بدون تغییر برمی‌گردانیم.

\*\* در نهایت setItems با آرایه جدید صدا زده می‌شود.

#### نکته مهم:

\*\*این روش باعث می‌شود React بتواند به‌درستی تشخیص دهد که داده‌ها تغییر کرده و رندر را به‌روزرسانی کند.
\*\*هرگز نباید مستقیماً state را تغییر دهیم (مثلاً تغییر مستقیم روی آرایه یا آبجکت موجود).
